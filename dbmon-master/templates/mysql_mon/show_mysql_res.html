{% extends 'base/base_site.html' %}

{% block content_header %}
    <section class="content-header">
      <h1>
        MySQL资源监控
      </h1>
        </h1>
        <ol class="breadcrumb">
        <li><a href="/begin"><i class="fa fa-dashboard"></i>首页</a></li>
        <li><a href="#">MySQL</a></li>
        <li class="active">资源监控</li>
      </ol>
    </section>
{% endblock %}
{% block content %}
    <div class="box box-success">
        <!-- /.box-header -->
        <div class="box-body">
       <div class="row">
            <div class="col-md-6">
            <form action="" method="post" id="myform">
                <div class="box-tools pull-left">
              <div class="form-group">
                <label>选择MySQL数据库：</label>
                <select onchange="submitForm();" class="form-control select2" style="width: 100%;" name="select_tags">
                <span class="glyphicon glyphicon-search form-control-feedback"></span>
                  <option selected="selected">{{ tagsdefault }}</option>
                  {% for tags in tagsinfo %}
                  <option>{{ tags.tags }}</option>
                   {% endfor %}
                </select>
              </div>
              <!-- /.form-group -->
            </div>
            <!-- /.col -->
            </form>
          </div>
                <div class="col-md-6">
           <div class="box-tools">
              <table class="table table-bordered text-center">
             <tbody>
                <a href="/show_mysql_res?tagsdefault={{ tagsdefault }}&range_default=1小时"><button type="button" class="btn bg-olive margin">1小时</button></a>
                 <a href="/show_mysql_res?tagsdefault={{ tagsdefault }}&range_default=1天"><button type="button" class="btn bg-olive margin">1天</button></a>
                <a href="/show_mysql_res?tagsdefault={{ tagsdefault }}&range_default=7天"><button type="button" class="btn bg-olive margin">7天</button></a>
                <a href="/show_mysql_res?tagsdefault={{ tagsdefault }}&range_default=30天"><button type="button" class="btn bg-olive margin">30天</button></a>
              </tbody></table>
              <!-- /.form-group -->
            </div>
        </div>
        </div>
        <!-- /.col -->
      </div>
      <!-- /.row -->
              <div class="box-body">
                  <div class="nav-tabs-custom">
            <ul class="nav nav-tabs">
              <li class="active"><a href="#res" data-toggle="tab" aria-expanded="false">资源</a></li>
              <li class=""><a href="#innodb" data-toggle="tab" aria-expanded="true">innodb</a></li>
              <li class=""><a href="#big_table" data-toggle="tab" aria-expanded="true">big table</a></li>
              <li class=""><a href="#log" data-toggle="tab" aria-expanded="true">日志</a></li>
            </ul>
            <div class="tab-content">
                <div class="active tab-pane" id="res">
          <div class="box box-solid">
            <div class="box-body" style="overflow: auto">
              <table id="example2" class="table table-bordered table-hover">
                <thead>
                <tr>
                  <th colspan="3"></th>
                  <th colspan="3">连接资源</th>
                  <th colspan="2">文件资源</th>
                  <th colspan="2">表资源</th>
                </tr>
                <tr>
                  <th style="width: 10px">ID</th>
                  <th>标签</th>
                    <th>IP</th>
                  <th>最大连接数</th>
                  <th>连接线程数</th>
                    <th>最大连接错误数</th>
                    <th>最大打开文件数</th>
                    <th>已打开文件数</th>
                    <th>表缓存数</th>
                    <th>已打开表</th>

                </tr>
                </thead>
                {% for dbinfo in dbinfo %}
                 <tr>
                 <td>{{ forloop.counter }} </td>
                 <td>{{ dbinfo.tags}} </td>
                 <td>{{ dbinfo.host }}</td>
                 <td>{{ dbinfo.max_connections}} </td>
                 <td>{{ dbinfo.threads_connected}} </td>
                 <td>{{ dbinfo.max_connect_errors}} </td>
                 <td>{{ dbinfo.open_files_limit}} </td>
                 <td>{{ dbinfo.open_files}} </td>
                 <td>{{ dbinfo.table_open_cache}} </td>
                 <td>{{ dbinfo.open_tables}} </td>
                 </tr>
                 {% endfor %}
              </table>
            </div>
            <!-- /.box-body -->
                      <!-- /.box-header -->
              <div class="box-header">
              <h3 class="box-title">键缓存</h3>
            </div>
            <div class="box-body" style="overflow: auto">
              <table id="example2" class="table table-bordered table-hover">
                <thead>
                <tr>
                  <th colspan="3"></th>
                  <th colspan="3">_buffer_size</th>
                  <th colspan="3">key_blocks_</th>
                  <th colspan="3">rate</th>
                </tr>
                <tr>
                  <th style="width: 10px">ID</th>
                  <th>标签</th>
                  <th>IP</th>
                  <th>key</th>
                  <th>sort</th>
                  <th>join</th>
                  <th>unused</th>
                  <th>used</th>
                  <th>not_flushed</th>
                  <th>key_blocks_used</th>
                  <th>key_buffer_read</th>
                  <th>key_buffer_write</th>
                </tr>
                </thead>
                {% for dbinfo in dbinfo %}
                 <tr>
                 <td>{{ forloop.counter }} </td>
                 <td>{{ dbinfo.tags }} </td>
                 <td>{{ dbinfo.host }} </td>
                 <td>{{ dbinfo.key_buffer_size }}mb</td>
                 <td>{{ dbinfo.sort_buffer_size }}kb </td>
                 <td>{{ dbinfo.join_buffer_size }}kb </td>
                 <td>{{ dbinfo.key_blocks_unused}} </td>
                 <td>{{ dbinfo.key_blocks_used }} </td>
                 <td>{{ dbinfo.key_blocks_not_flushed }} </td>
                 <td>{{ dbinfo.key_blocks_used_rate }}% </td>
                 <td>{{ dbinfo.key_buffer_read_rate }}% </td>
                 <td>{{ dbinfo.key_buffer_write_rate }}% </td>
                 </tr>
                 {% endfor %}
              </table>
            </div>
          </div>

         <div class="row">
          <!-- /.row -->
             <!-- /.box -->
            <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">打开文件、表数量</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="file-grow-chart" style="height: 300px;"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
         <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">慢查询数量</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="slow-grow-chart" style="height: 300px;"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
            <!-- interactive chart -->
         <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">每秒sql执行次数</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="sql-grow-chart" style="height: 300px;"></div>
            </div>
            <!-- /.box-body-->
        </div>
                        <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">全表扫描数</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="fullscan-grow-chart" style="height: 300px;"></div>
            </div>
            <!-- /.box-body-->
         </div>
            <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">MyISAM读写次数</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="rwcnt-grow-chart" style="height: 300px;"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
             <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">MyISAM  Key Buffer读写利用率</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="key-grow-chart" style="height: 300px;"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
        </div>
        </div>
          <div class="tab-pane" id="innodb">
           <div class="box box-solid">
            <!-- /.box-header -->
            <div class="box-body" style="overflow: auto">
              <table id="example2" class="table table-bordered table-hover">
                <thead>
                <tr>
                  <th colspan="3"></th>
                  <th colspan="1">innodb_buffer_pool</th>
                  <th colspan="5">Pages</th>
                  <th colspan="3">IO</th>
                  <th colspan="4">Innodb_rows</th>
                </tr>
                <tr>
                  <th style="width: 10px">ID</th>
                  <th>标签</th>
                  <th>IP</th>
                  <th>size</th>
                  <th>total</th>
                  <th>data</th>
                  <th>dirty</th>
                  <th>flushed</th>
                  <th>free</th>
                  <th>capacity</th>
                  <th>read_thread</th>
                  <th>write_thread</th>
                  <th>read</th>
                  <th>insert</th>
                  <th>update</th>
                  <th>delete</th>
                </tr>
                </thead>
                {% for dbinfo in dbinfo %}
                 <tr>
                  <td>{{ forloop.counter }} </td>
                  <td>{{ dbinfo.tags }}</td>
                  <td>{{ dbinfo.host }}</td>
                  <td>{{ dbinfo.innodb_buffer_pool_size }}mb</td>
                  <td>{{ dbinfo.innodb_buffer_pool_pages_total }}</td>
                  <td>{{ dbinfo.innodb_buffer_pool_pages_data }}</td>
                  <td>{{ dbinfo.innodb_buffer_pool_pages_dirty }}</td>
                  <td>{{ dbinfo.innodb_buffer_pool_pages_flushed }}</td>
                  <td>{{ dbinfo.innodb_buffer_pool_pages_free }}</td>
                  <td>{{ dbinfo.innodb_io_capacity }}</td>
                  <td>{{ dbinfo.innodb_read_io_threads }}</td>
                  <td>{{ dbinfo.innodb_write_io_threads }}</td>
                  <td>{{ dbinfo.innodb_rows_read_persecond }}</td>
                  <td>{{ dbinfo.innodb_rows_inserted_persecond }}</td>
                  <td>{{ dbinfo.innodb_rows_updated_persecond }}</td>
                  <td>{{ dbinfo.innodb_rows_deleted_persecond }}</td>
                 </tr>
                 {% endfor %}
              </table>
             </div>
          </div>
              <div class="row">
          <!-- /.row -->
             <!-- /.box -->
            <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB缓冲区命中率</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="bhit-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
         <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB缓冲区使用率、脏块率</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="usage-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
            <!-- interactive chart -->
         <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB锁等待次数</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="lockwaits-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
        </div>
                        <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB锁平均等待时间</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="lockavg-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
         </div>
            <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB脏页数量</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="dirtypages-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
             <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB脏页刷新频率</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="dirtyflushed-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
               <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB读写量</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="read-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
                  <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB读写次数</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="reads-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
                  <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB日志文件写次数</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="logwrites-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
                  <!-- interactive chart -->
            <div class="col-xs-6">
            <!-- /.col -->
            <div class="box-header with-border">
              <i class="fa fa-bar-chart-o"></i>
              <h3 class="box-title">InnoDB日志写出量</h3>
            </div>

            <div class="box-body">
                <div class="row">
          <!-- /.row -->
        </div>
              <div class="conn" id="logkb-grow-chart" style="height: 300px; width: 437px"></div>
            </div>
            <!-- /.box-body-->
         </div>
          <!-- /.box -->
        </div>
              </div>
              <!-- /.tab-pane -->

              <div class="tab-pane" id="big_table">
           <div class="box box-solid">
            <!-- /.box-header -->
            <div class="box-body" style="overflow: auto">
              <table id="example2" class="table table-bordered table-hover">
                <thead>
                <tr>
                  <th style="width: 10px">ID</th>
                  <th>标签</th>
                  <th>IP</th>
                  <th>数据库名</th>
                  <th>表名</th>
                  <th>大小</th>
                  <th>表注释</th>
                  <th>增长趋势</th>
                </tr>
                </thead>
                {% for big_table in big_table_list %}
                 <tr>
                  <td>{{ forloop.counter }} </td>
                  <td>{{ big_table.tags }}</td>
                  <td>{{ big_table.host }}</td>
                  <td>{{ big_table.db }}</td>
                  <td>{{ big_table.table_name }}</td>
                  <td>{{ big_table.total }}mb</td>
                  <td>{{ big_table.table_comment }}</td>
                  <td> <li><a href="/mysql_big_table?tags={{ big_table.tags }}&db={{ big_table.db }}&table_name={{ big_table.table_name }}" >详情</a></li> </td>
                 </tr>
                 {% endfor %}
              </table>
             </div>
          </div>
              </div>
              <!-- /.tab-pane -->

                <div class="tab-pane" id="log">
            {% for log in mysql_alert_logs %}
        <div class="box-header with-border">
          <h3 class="box-title">{{ log.log_time }} <small style="color: {% if log.log_level == 'error' %} red  {% endif %};">{{ log.log_level }}</small></h3>
        </div>
        <div class="box-body">
            <pre>{{ log.log_content }}</pre>
        </div>
        <!-- /.box-body -->
        <!-- /.box-footer-->
              {% endfor %}
              </div>
              <!-- /.tab-pane -->

            </div>
            <!-- /.tab-content -->
          </div>
          <!-- /.nav-tabs-custom -->
        </div>
        </div>
{% endblock %}

{% block javascripts %}

<script>
 //表单提交
function submitForm(){
    var form = document.getElementById("myform");
    form.submit();
}

  //表单提交
function submittype(){
    var form = document.getElementById("mytype");
    form.submit();
}

   // ####################  【打开文件、表数量趋势】图形  ####################
 var myChart_file_grow = echarts.init(document.getElementById('file-grow-chart'));
 option_file_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['open_files','open_tables']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'open_files',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.open_files }},{% endfor %}]
         },
          {
             name:'open_tables',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#79d4bc"
              }
              },
              lineStyle: {
               normal: {
                color: "#79d4bc"
              }
              },
             areaStyle: {
               normal: {
                color: "#79d4bc",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.open_tables }},{% endfor %}]
         }
     ]
 };
 myChart_file_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_file_grow.hideLoading();  //显示完成后不显示loading
     myChart_file_grow.setOption(option_file_grow, true);
 },500);

    // ####################  【慢查询数趋势】图形  ####################
 var myChart_slow_grow = echarts.init(document.getElementById('slow-grow-chart'));
 option_slow_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['slow queries']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'select scan',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.slow_queries }},{% endfor %}]
         }
     ]
 };
 myChart_slow_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_slow_grow.hideLoading();  //显示完成后不显示loading
     myChart_slow_grow.setOption(option_slow_grow, true);
 },500);

   // ####################  【每秒sql执行次数趋势】图形  ####################
 var myChart_sql_grow = echarts.init(document.getElementById('sql-grow-chart'));
 option_sql_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['mysql_sel','mysql_ins','mysql_upd','mysql_del']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'mysql_sel',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.mysql_sel }},{% endfor %}]
         },
          {
             name:'mysql_ins',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#79d4bc"
              }
              },
              lineStyle: {
               normal: {
                color: "#79d4bc"
              }
              },
             areaStyle: {
               normal: {
                color: "#79d4bc",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.mysql_ins }},{% endfor %}]
         },
         {
             name:'mysql_upd',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#828dd4"
              }
              },
              lineStyle: {
               normal: {
                color: "#828dd4"
              }
              },
             areaStyle: {
               normal: {
                color: "#828dd4",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.mysql_upd }},{% endfor %}]
         },
         {
             name:'mysql_del',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#ce7258"
              }
              },
              lineStyle: {
               normal: {
                color: "#ce7258"
              }
              },
             areaStyle: {
               normal: {
                color: "#ce7258",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.mysql_del }},{% endfor %}]
         }
     ]
 };
 myChart_sql_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_sql_grow.hideLoading();  //显示完成后不显示loading
     myChart_sql_grow.setOption(option_sql_grow, true);
 },500);

   // ####################  【全表扫描数趋势】图形  ####################
 var myChart_fullscan_grow = echarts.init(document.getElementById('fullscan-grow-chart'));
 option_fullscan_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['select scan']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'select scan',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.select_scan }},{% endfor %}]
         }
     ]
 };
 myChart_fullscan_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_fullscan_grow.hideLoading();  //显示完成后不显示loading
     myChart_fullscan_grow.setOption(option_fullscan_grow, true);
 },500);

   // ####################  【Mysam读写次数趋势】图形  ####################
 var myChart_rwcnt_grow = echarts.init(document.getElementById('rwcnt-grow-chart'));
 option_rwcnt_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['key_read_requests','Key_reads','Key_write_requests','Key_writes']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'key_read_requests',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.key_read_requests }},{% endfor %}]
         },
          {
             name:'Key_reads',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#79d4bc"
              }
              },
              lineStyle: {
               normal: {
                color: "#79d4bc"
              }
              },
             areaStyle: {
               normal: {
                color: "#79d4bc",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.key_reads }},{% endfor %}]
         },
         {
             name:'Key_write_requests',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#828dd4"
              }
              },
              lineStyle: {
               normal: {
                color: "#828dd4"
              }
              },
             areaStyle: {
               normal: {
                color: "#828dd4",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.key_write_requests }},{% endfor %}]
         },
         {
             name:'Key_writes',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#ce7258"
              }
              },
              lineStyle: {
               normal: {
                color: "#ce7258"
              }
              },
             areaStyle: {
               normal: {
                color: "#ce7258",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.Key_writes }},{% endfor %}]
         }
     ]
 };
 myChart_rwcnt_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_rwcnt_grow.hideLoading();  //显示完成后不显示loading
     myChart_rwcnt_grow.setOption(option_rwcnt_grow, true);
 },500);

   // ####################  【Key Buffer读写利用率趋势】图形  ####################
 var myChart_key_grow = echarts.init(document.getElementById('key-grow-chart'));
 option_key_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['key_buffer_read_rate','key_buffer_write_rate']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'key_buffer_read_rate',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.key_buffer_read_rate }},{% endfor %}]
         },
          {
             name:'key_buffer_write_rate',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#79d4bc"
              }
              },
              lineStyle: {
               normal: {
                color: "#79d4bc"
              }
              },
             areaStyle: {
               normal: {
                color: "#79d4bc",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.key_buffer_write_rate }},{% endfor %}]
         }
     ]
 };
 myChart_key_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_key_grow.hideLoading();  //显示完成后不显示loading
     myChart_key_grow.setOption(option_key_grow, true);
 },500);

   // ####################  【innodb缓冲区命中率趋势】图形  ####################
 var myChart_bhit_grow = echarts.init(document.getElementById('bhit-grow-chart'));
 option_bhit_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['命中率']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'命中率%',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_buffer_pool_hit }},{% endfor %}]
         }
     ]
 };
 myChart_bhit_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_bhit_grow.hideLoading();  //显示完成后不显示loading
     myChart_bhit_grow.setOption(option_bhit_grow, true);
 },500);

   // ####################  【Innodb缓冲区使用率、脏块率趋势】图形  ####################
 var myChart_usage_grow = echarts.init(document.getElementById('usage-grow-chart'));
 option_usage_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['使用率','脏块率']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'使用率',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_buffer_usage}},{% endfor %}]
         },
          {
             name:'脏块率',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#79d4bc"
              }
              },
              lineStyle: {
               normal: {
                color: "#79d4bc"
              }
              },
             areaStyle: {
               normal: {
                color: "#79d4bc",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_buffer_dirty_rate }},{% endfor %}]
         }
     ]
 };
 myChart_usage_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_usage_grow.hideLoading();  //显示完成后不显示loading
     myChart_usage_grow.setOption(option_usage_grow, true);
 },500);

   // ####################  【Innodb锁等待次数趋势】图形  ####################
 var myChart_lockwaits_grow = echarts.init(document.getElementById('lockwaits-grow-chart'));
 option_lockwaits_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['锁等待次数']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'锁等待次数',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_row_lock_waits}},{% endfor %}]
         }
     ]
 };
 myChart_lockwaits_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_lockwaits_grow.hideLoading();  //显示完成后不显示loading
     myChart_lockwaits_grow.setOption(option_lockwaits_grow, true);
 },500);

   // ####################  【Innodb锁平均等待时间趋势】图形  ####################
 var myChart_lockavg_grow = echarts.init(document.getElementById('lockavg-grow-chart'));
 option_lockavg_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['平均等待时间(ms)']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'平均等待时间(ms)',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_row_lock_time_avg}},{% endfor %}]
         }
     ]
 };
 myChart_lockavg_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_lockavg_grow.hideLoading();  //显示完成后不显示loading
     myChart_lockavg_grow.setOption(option_lockavg_grow, true);
 },500);

   // ####################  【Innodb脏页数量趋势】图形  ####################
 var myChart_dirtypages_grow = echarts.init(document.getElementById('dirtypages-grow-chart'));
 option_dirtypages_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['脏页数量']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'脏页数量',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_buffer_pool_pages_dirty}},{% endfor %}]
         }
     ]
 };
 myChart_dirtypages_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_dirtypages_grow.hideLoading();  //显示完成后不显示loading
     myChart_dirtypages_grow.setOption(option_dirtypages_grow, true);
 },500);

   // ####################  【Innodb脏页刷新频率趋势】图形  ####################
 var myChart_dirtyflushed_grow = echarts.init(document.getElementById('dirtyflushed-grow-chart'));
 option_dirtyflushed_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['脏页刷新频率']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'脏页刷新频率',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_buffer_pool_pages_flushed_delta}},{% endfor %}]
         }
     ]
 };
 myChart_dirtyflushed_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_dirtyflushed_grow.hideLoading();  //显示完成后不显示loading
     myChart_dirtyflushed_grow.setOption(option_dirtyflushed_grow, true);
 },500);

   // ####################  【Innodb读写量趋势】图形  ####################
 var myChart_read_grow = echarts.init(document.getElementById('read-grow-chart'));
 option_read_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['读数量(KB)','写数量(KB)']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'读数量(KB)',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_data_read}},{% endfor %}]
         },
          {
             name:'写数量(KB)',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#79d4bc"
              }
              },
              lineStyle: {
               normal: {
                color: "#79d4bc"
              }
              },
             areaStyle: {
               normal: {
                color: "#79d4bc",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_data_written }},{% endfor %}]
         }
     ]
 };
 myChart_read_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_read_grow.hideLoading();  //显示完成后不显示loading
     myChart_read_grow.setOption(option_read_grow, true);
 },500);

   // ####################  【Innodb读写次数趋势】图形  ####################
 var myChart_reads_grow = echarts.init(document.getElementById('reads-grow-chart'));
 option_reads_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['读次数','写次数']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'读次数',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_data_reads}},{% endfor %}]
         },
          {
             name:'写次数',
             type:'line',
             smooth: true,
              itemStyle: {
              normal: {
                color: "#79d4bc"
              }
              },
              lineStyle: {
               normal: {
                color: "#79d4bc"
              }
              },
             areaStyle: {
               normal: {
                color: "#79d4bc",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_data_writes }},{% endfor %}]
         }
     ]
 };
 myChart_reads_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_reads_grow.hideLoading();  //显示完成后不显示loading
     myChart_reads_grow.setOption(option_reads_grow, true);
 },500);

   // ####################  【Innodb日志读写次数】图形  ####################
 var myChart_logwrites_grow = echarts.init(document.getElementById('logwrites-grow-chart'));
 option_logwrites_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['日志写出次数']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'日志写出次数',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_log_writes}},{% endfor %}]
         }
     ]
 };
 myChart_logwrites_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_logwrites_grow.hideLoading();  //显示完成后不显示loading
     myChart_logwrites_grow.setOption(option_logwrites_grow, true);
 },500);

   // ####################  【Innodb读写量趋势】图形  ####################
 var myChart_logkb_grow = echarts.init(document.getElementById('logkb-grow-chart'));
 option_logkb_grow = {
     tooltip: {
         trigger: 'axis',
         axisPointer: {
             type: 'cross'
         }
     },
         legend: {
        data:['日志写出量(KB)']
    },
     toolbox: {
         show: true,
         feature: {
             saveAsImage: {}
         }
     },
     xAxis:  {
         type: 'category',
         boundaryGap: false,
         zlevel: 1,
         data: [{% for i in mysql_grow_list %}'{{ i.chk_time | date:"m-d H:i:s" }}',{% endfor %}]
     },
     yAxis: {
         type: 'value',
         axisLabel: {
             formatter: '{value}'
         },
         axisPointer: {
             snap: true
         },
         scale: true
     },
     series: [
         {
             name:'日志写出量(KB)',
             type:'line',
             smooth: true,
             itemStyle: {
              normal: {
                color: "#d4d098"
              }
              },
              lineStyle: {
               normal: {
                color: "#d4d098"
              }
              },
             areaStyle: {
               normal: {
                color: "#d4d098",
                opacity: 0.8
               }
             },
             data: [{% for i in mysql_grow_list %}{{ i.innodb_os_log_written}},{% endfor %}]
         }
     ]
 };
 myChart_logkb_grow.showLoading();  //显示loading
 setInterval(function () {
     myChart_logkb_grow.hideLoading();  //显示完成后不显示loading
     myChart_logkb_grow.setOption(option_logkb_grow, true);
 },500);

</script>
<script>
</script>
{% endblock %}