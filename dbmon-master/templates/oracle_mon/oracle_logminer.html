{% extends 'base/base_site.html' %}{% block content_header %}        <!-- Content Header (Page header) -->    <section class="content-header">      <h1>        Oracle日志挖掘      </h1>        </h1>        <ol class="breadcrumb">        <li><a href="/begin"><i class="fa fa-dashboard"></i>首页</a></li>        <li><a href="#">自动化运维</a></li>        <li><a href="/my_tools">工具包</a></li>        <li class="active">Oracle日志挖掘</li>      </ol>    </section>{% endblock %}{% block content %}        <div class="box box-success">        <!-- /.box-header -->        <div class="box-body">          <div class="row">            <div class="col-md-6">            <form action="" method="post" id="myform">                <div class="box-tools pull-left">              <div class="form-group">                <label>选择Oracle数据库：</label>                <select onchange="submitForm();" class="form-control select2" style="width: 100%;" name="select_tags">                <span class="glyphicon glyphicon-search form-control-feedback"></span>                  <option selected="selected">{{ tagsdefault }}</option>                  {% for tags in tagsinfo %}                  <option>{{ tags.tags }}</option>                   {% endfor %}                </select>              </div>              <!-- /.form-group -->            </div>                      <!-- SELECT2 EXAMPLE -->            </form>          </div>        </div>        <div class="box box-solid ">        <!-- /.box-body -->         <div class="box-header">              <h3 class="box-title">解析日志文件列表</h3>             <div class="box-tools pull-right">            <button type="button" class="btn btn-default" data-toggle="tooltip" title="" data-original-title="Add" onclick="return pop_add('{{ tagsdefault }}')">              <i class="fa fa-upload"></i></button>          </div>            </div>            <!-- /.box-header -->            <div class="box-body">              <table id="example2" class="table table-bordered table-hover">                <thead>                <tr>                    <th>ID</th>                    <th>日志文件</th>                </tr>                </thead>                {% for log in log_list %}                 <tr>                 <td>{{ log.id}} </td>                 <td>{{ log.logfile }} </td>                 </tr>                 {% endfor %}              </table>            </div>                </div>                    <!-- /.row -->        <form class="" action="" method="POST">        <div class="col-xs-3">       <div class="input-group">                <span class="input-group-addon">用户过滤</span>                <input type="text" class="form-control" name="schema" placeholder="必填" required="required">              </div>        </div>        <div class="col-xs-3">             <div class="input-group">                <span class="input-group-addon">对象过滤</span>                <input type="text" class="form-control" name="object" placeholder="选填">              </div>        </div>            <div class="col-xs-3">       <div class="input-group">                <span class="input-group-addon">操作类型过滤</span>                 <select class="form-control select2" style="width: 100%;" name="operation">                <span class="glyphicon glyphicon-search form-control-feedback"></span>                  <option selected="selected"></option>                  <option>DELETE</option>                      <option>INSERT</option>                      <option>UPDATE</option>                     <option>TRUNCATE</option>                     <option>DROP</option>                </select>              </div>        </div>         <div class="col-xs-2">      <div class="form-group">          <button type="submit" class="btn bg-block btn-default bg-teal" name="commit">开始解析</button>         </div>        </div>       </form>     </div>          <div class="box box-solid ">              <!-- /.box-header -->        <div class="box-body">        <!-- /.box-body -->         <div class="box-header">              <h3 class="box-title">解析结果</h3>            </div>            <!-- /.box-header -->            <div class="box-body" style="overflow: auto">              <table id="table1" class="table table-bordered table-hover" style="table-layout: auto">                <thead>                <tr>                    <th>时间</th>                    <th>操作类型</th>                    <th>是否回滚</th>                    <th>段用户</th>                    <th>段名称</th>                    <th>表名</th>                    <th>段类型</th>                    <th>用户</th>                    <th>操作系统用户</th>                    <th>操作系统主机名</th>                    <th>SQL_UNDO</th>                    <th>SQL_REDO</th>                </tr>                </thead>                {% for logmnr_content in logmnr_contents %}                 <tr>                 <td>{{ logmnr_content.TIMESTAMP}} </td>                 <td>{{ logmnr_content.OPERATION }} </td>                 <td>{{ logmnr_content.ROLLBACK }} </td>                 <td>{{ logmnr_content.SEG_OWNER }} </td>                 <td>{{ logmnr_content.SEG_NAME }} </td>                 <td>{{ logmnr_content.TABLE_NAME }} </td>                 <td>{{ logmnr_content.SEG_TYPE_NAME }} </td>                 <td>{{ logmnr_content.USERNAME }} </td>                 <td>{{ logmnr_content.OS_USERNAME }} </td>                 <td>{{ logmnr_content.MACHINE_NAME }} </td>                 <td> <li><a href="#"  onclick="pop_content('{{ tagsdefault }}','{{ logmnr_content.ID }}')" >{{ logmnr_content.SQL_UNDO }}</a></li> </td>                 <td> <li><a href="#"  onclick="pop_content('{{ tagsdefault }}','{{ logmnr_content.ID }}')" >{{ logmnr_content.SQL_REDO }}</a></li> </td>                 </tr>                 {% endfor %}              </table>            </div>      </div>     </div>      </div>{% endblock %}{% block javascripts %}<script> //表单提交function submitForm(){    var form = document.getElementById("myform");    form.submit();}  //表单提交function submittype(){    var form = document.getElementById("mytype");    form.submit();}function pop_add(n){    layer.open({    type: 2,    title: '添加日志文件',    closeBtn: 1,    area: ['750px', '550px'],    shadeClose: true, //点击遮罩关闭    content: ['/oracle_logs_add/?tags='+n,],    end:function(){            var handle_status = $("#handle_status").val();            if ( handle_status == '1' ) {                layer.msg('添加成功！',{                    icon: 1,                    time: 2000 //2秒关闭（如果不配置，默认是3秒）                },function(){                    history.go(0);                });            } else if ( handle_status == '2' ) {                layer.msg('添加失败！',{                    icon: 2,                    time: 2000 //2秒关闭（如果不配置，默认是3秒）                },function(){                    history.go(0);                });            }        }  });}function pop_content(m,n){    layer.open({    type: 2,    title: 'sql文本',    closeBtn: 1,    area: ['750px', '550px'],    shadeClose: true, //点击遮罩关闭    content: ['/show_sqltext/?tags='+m + '&id='+n,],    });}</script>{% endblock %}